#!/usr/bin/env python3
"""
concert_info.csvì—ì„œ ì˜ë¦° í…ìŠ¤íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ìˆ˜ì •í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
AI ì—†ì´ ì§ì ‘ 100ìì— ë§ì¶° ì™„ì„±
"""
import pandas as pd
from pathlib import Path
import time

def fix_truncated_text(artist_name, concert_title, category, truncated_content):
    """ì˜ë¦° í…ìŠ¤íŠ¸ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ì™„ì„± (100ì ì œí•œ)"""
    
    # ê° ì¼€ì´ìŠ¤ë³„ë¡œ ì§ì ‘ ìˆ˜ì •
    fixes = {
        "ASCA (ì•„ìŠ¤ì¹´)": "ë¬´ì‹ ì‚¬ ê°œëŸ¬ì§€ ê³µì—°ì¥ ë‚´ì—ëŠ” ìœ ë£Œ ë¬¼í’ˆë³´ê´€í•¨ì´ ë¹„ì¹˜ë˜ì–´ ìˆì–´ ê°œì¸ ì†Œì§€í’ˆì„ ë³´ê´€í•  ìˆ˜ ìˆì—ˆì–´ìš”. êµ¿ì¦ˆ íŒë§¤ ì—¬ë¶€ëŠ” ê³µì—°ë§ˆë‹¤ ë‹¤ë¥´ë‹ˆ í™•ì¸í•´ë³´ì„¸ìš”.",
        "CHRISTOPHER (í¬ë¦¬ìŠ¤í† í¼)": "ê³µì—°ì¥ ì£¼ë³€ì—ëŠ” ì—¬ëŸ¬ í¸ì˜ì ì„ ì‰½ê²Œ ì°¾ì„ ìˆ˜ ìˆì§€ë§Œ ê³µì—°ì¥ê³¼ ê°€ì¥ ê°€ê¹Œìš´ í¸ì˜ì ì€ CU ì˜¬ë¦¼í”½ê³µì›1í˜¸ì ì´ì˜ˆìš”. í•¸ë“œë³¼ê²½ê¸°ì¥ê³¼ KSPO DOME ì‚¬ì´ì— ìˆì–´ìš”.",
        "Elijah Woods (ì—˜ë¦¬ì•¼ ìš°ì¦ˆ)": "ë¬´ì‹ ì‚¬ ê°œëŸ¬ì§€ ê³µì—°ì¥ ë‚´ì—ëŠ” ìœ ë£Œ ë¬¼í’ˆë³´ê´€í•¨ì´ ë¹„ì¹˜ë˜ì–´ ìˆì–´ ê°œì¸ ì†Œì§€í’ˆì„ ë³´ê´€í•  ìˆ˜ ìˆì–´ìš”. 500ì› ë™ì „ 2ê°œë¥¼ íˆ¬ì…í•´ì•¼ ì´ìš©í•  ìˆ˜ ìˆìœ¼ë‹ˆ ì¤€ë¹„í•˜ì„¸ìš”.",
        "Eric Martin (ì—ë¦­ ë§ˆí‹´)": "ë¬´ì‹ ì‚¬ ê°œëŸ¬ì§€ ê³µì—°ì¥ ë‚´ì—ëŠ” ìœ ë£Œ ë¬¼í’ˆë³´ê´€í•¨ì´ ë¹„ì¹˜ë˜ì–´ ìˆì–´ ê°œì¸ ì†Œì§€í’ˆì„ ë³´ê´€í•  ìˆ˜ ìˆì–´ìš”. 500ì› ë™ì „ 2ê°œë¥¼ íˆ¬ì…í•´ì•¼ ì´ìš©í•  ìˆ˜ ìˆìœ¼ë‹ˆ ì¤€ë¹„í•˜ì„¸ìš”.",
        "Jacky Cheung (ì¥í•™ìš°)": "ê³µì—°ì¥ ë‚´ì—ì„œëŠ” ê´€ê° ì—¬ëŸ¬ë¶„ë“¤ì„ ìœ„í•´ êµ¿ì¦ˆ íŒë§¤ ë¶€ìŠ¤ê°€ ìš´ì˜ë  ì˜ˆì •ì´ì—ˆì–´ìš”. ì¸ìŠ¤íŒŒì´ì–´ ë¦¬ì¡°íŠ¸ ë‚´ ë‹¤ì–‘í•œ ì‹ìŒë£Œ ì‹œì„¤ë„ ì´ìš© ê°€ëŠ¥í•´ìš”.",
        "JAKE MILLER (ì œì´í¬ ë°€ëŸ¬)": "ë¬´ì‹ ì‚¬ ê°œëŸ¬ì§€ ê³µì—°ì¥ ë‚´ì—ëŠ” ìœ ë£Œ ë¬¼í’ˆë³´ê´€í•¨ì´ ë¹„ì¹˜ë˜ì–´ ìˆì–´ ê°œì¸ ì†Œì§€í’ˆì„ ë³´ê´€í•  ìˆ˜ ìˆì–´ìš”. 500ì› ë™ì „ 2ê°œë¥¼ íˆ¬ì…í•´ì•¼ ì´ìš©í•  ìˆ˜ ìˆìœ¼ë‹ˆ ì¤€ë¹„í•˜ì„¸ìš”.",
        "John Carroll Kirby (ì¡´ ìºëŸ´ ì»¤ë¹„)": "ì œì£¼ ì„œê·€í¬ì‹œì— ìœ„ì¹˜í•œ ê³µì—°ì¥ í•˜ìš°ìŠ¤ì˜¤ë¸Œë ˆí“¨ì¦ˆëŠ” ì œì£¼ì‹œ ì• ì›”ì ìˆ²ì†ì— 20ì—¬ ë…„ê°„ ë°©ì¹˜ëë˜ íê±´ë¬¼ì— ìƒˆ ìƒëª…ì„ ë¶ˆì–´ë„£ì–´ íƒ„ìƒí•œ ë©‹ì§„ ê³µê°„ì´ì˜ˆìš”.",
        "JVKE (ì œì´í¬)": "ê³µì—°ì¥ì¸ ì˜¬ë¦¼í”½ê³µì› ì£¼ì°¨ìš”ê¸ˆì€ 10ë¶„ë‹¹ 600ì›ì´ê³  ì¼ ìµœëŒ€ 20,000ì›ì´ì˜ˆìš”. ì£¼ì°¨ ê³µê°„ì€ ì¶©ë¶„í•˜ë‚˜ í˜¼ì¡í•  ìˆ˜ ìˆìœ¼ë‹ˆ ëŒ€ì¤‘êµí†µ ì´ìš©ì„ ê¶Œì¥í•´ìš”.",
        "Mei Semones (ë©”ì´ ì‹œëª¬ìŠ¤)": "Mei Semones Live [ì„œìš¸] ì½˜ì„œíŠ¸ì˜ í‹°ì¼“ ê°€ê²©ì€ ì „ì„ ìŠ¤íƒ ë”© 77,000ì›ì´ì—ˆì–´ìš”. ì˜ˆìŠ¤24 í‹°ì¼“ì„ í†µí•´ 2024ë…„ 3ì›” 12ì¼ì— ì˜¤í”ˆë˜ì—ˆì–´ìš”.",
        "MUSE (ë®¤ì¦ˆ)": "ì¸ì²œ SSG ëœë”ìŠ¤í•„ë“œëŠ” ì§€í•˜ ë° ì§€ìƒ ì£¼ì°¨ì¥ì„ ìì²´ì ìœ¼ë¡œ ìš´ì˜í•˜ê³  ìˆì–´ìš”. ì´ 4002ëŒ€ ì£¼ì°¨ ê°€ëŠ¥í•˜ê³  í•˜ë£¨ì— 2,000ì›ìœ¼ë¡œ ì €ë ´í•˜ê²Œ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”.",
        "NEMOPHILA (ë„¤ëª¨í•„ë¼)": "ì˜ˆìŠ¤24 ì›ë”ë¡œí¬í™€ì—ëŠ” ë¬¼í’ˆë³´ê´€ì†Œì™€ ë™ì „êµí™˜ê¸°ê°€ ìˆìœ¼ë©° ê³µì—°ì¥ ë‚´ ì‹ìŒë£Œ íŒë§¤ëŠ” ê³µì—°ë³„ë¡œ ë‹¤ë¥¼ ìˆ˜ ìˆì–´ìš”. ì£¼ì°¨ì¥ì´ ì—†ìœ¼ë‹ˆ ëŒ€ì¤‘êµí†µ ì´ìš©ì„ ê¶Œì¥í•´ìš”.",
        "Pink Sweat$ (í•‘í¬ìŠ¤ì›¨ì¸ )": "ê³µì—°ì´ ì§„í–‰ë˜ëŠ” YES24 LIVE HALLì€ ì „ìš© ì£¼ì°¨ ê³µê°„ì´ ì—†ì–´ì„œ ëŒ€ì¤‘êµí†µ ì´ìš©ì„ ê¶Œì¥í•´ìš”. ì§€í•˜ì²  5í˜¸ì„  ê´‘ë‚˜ë£¨ì—­ 2ë²ˆ ì¶œêµ¬ì—ì„œ ë„ë³´ 3ë¶„ì´ì˜ˆìš”.",
        "SCANDAL (ìŠ¤ìº”ë“¤)": "ê³µì—°ì¥ ì£¼ë³€ ì£¼ì°¨ ê³µê°„ì´ í˜‘ì†Œí•˜ë¯€ë¡œ ê°€ê¸‰ì  ëŒ€ì¤‘êµí†µ ì´ìš©ì„ ê¶Œì¥í•˜ë©°, ì°¨ëŸ‰ ì´ìš© ì‹œì—ëŠ” ì¸ê·¼ ìœ ë£Œ ê³µì˜ì£¼ì°¨ì¥ì„ ì´ìš©í•˜ì…”ì•¼ í•´ìš”. ë¬¼í’ˆë³´ê´€í•¨ë„ ìˆì–´ìš”.",
        "SEKAI NO OWARI (ì„¸ì¹´ì´ ë…¸ ì˜¤ì™€ë¦¬)": "ê³ ë ¤ëŒ€í•™êµ í™”ì •ì²´ìœ¡ê´€ì€ ë§¤ìš° ë†’ì€ ì§€ëŒ€ì— ìœ„ì¹˜í•˜ê³  ìˆì–´ ë„ë³´ ì´ë™ì€ ì¶”ì²œí•˜ì§€ ì•Šì•„ìš”. ì„±ë¶20 ë²„ìŠ¤ë‚˜ ì„±ì‹ ì—¬ëŒ€ì—­ì—ì„œ íƒì‹œë¥¼ ì´ìš©í•˜ì‹œëŠ” ê²ƒì´ í¸í•´ìš”.",
        "toconoma (í† ì½”ë…¸ë§ˆ)": "ê³µì—°ì¥ì¸ í™ëŒ€ ìƒìƒë§ˆë‹¹ì˜ ê±´ë¬¼ ì£¼ì°¨ì¥ì€ ì´ìš©í•  ìˆ˜ ì—†ì§€ë§Œ 30ë¶„ì— 2,000ì›, 1ì‹œê°„ì— 4,000ì›ìœ¼ë¡œ ê·¼ì²˜ LGíŒ°ë¦¬ìŠ¤ ê³µì˜ì£¼ì°¨ì¥ì„ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”.",
        "toe (í† )": "ë¬´ì‹ ì‚¬ ê°œëŸ¬ì§€ ê³µì—°ì¥ ë‚´ì—ëŠ” ìœ ë£Œ ë¬¼í’ˆë³´ê´€í•¨ì´ ë¹„ì¹˜ë˜ì–´ ìˆì–´ ê°œì¸ ì†Œì§€í’ˆì„ ë³´ê´€í•  ìˆ˜ ìˆì–´ìš”. 500ì› ë™ì „ 2ê°œë¥¼ íˆ¬ì…í•´ì•¼ ì´ìš©í•  ìˆ˜ ìˆìœ¼ë‹ˆ ì¤€ë¹„í•˜ì„¸ìš”.",
        "Travis Scott (íŠ¸ë˜ë¹„ìŠ¤ ìŠ¤ìº‡)": "ê³ ì–‘ì¢…í•©ìš´ë™ì¥ì€ ìì²´ ì£¼ì°¨ì¥ì„ 24ì‹œê°„ ìš´ì˜í•´ìš”. ì£¼ì°¨ ê°€ëŠ¥ ëŒ€ìˆ˜ëŠ” ì•½ 1,000ëŒ€ë¡œ, ìµœì´ˆ 1ì‹œê°„ 1,000ì›, ì´í›„ 5ë¶„ë‹¹ 170ì›ì´ ë¶€ê³¼ë¼ìš”.",
        "Tyler, The Creator (íƒ€ì¼ëŸ¬, ë” í¬ë¦¬ì—ì´í„°)": "ê³ ì–‘ì¢…í•©ìš´ë™ì¥ì€ ìì²´ ì£¼ì°¨ì¥ì„ 24ì‹œê°„ ìš´ì˜í•´ìš”. ì£¼ì°¨ ê°€ëŠ¥ ëŒ€ìˆ˜ëŠ” ì•½ 1,000ëŒ€ë¡œ, ìµœì´ˆ 1ì‹œê°„ 1,000ì›, ì´í›„ 5ë¶„ë‹¹ 170ì›ì´ ë¶€ê³¼ë¼ìš”.",
        "yama (ì•¼ë§ˆ)": "ì˜ˆìŠ¤24 ì›ë”ë¡œí¬í™€ì—ëŠ” ë¬¼í’ˆë³´ê´€ì†Œì™€ ë™ì „êµí™˜ê¸°ê°€ ìˆìœ¼ë©° ê³µì—°ì¥ ë‚´ ì‹ìŒë£Œ íŒë§¤ëŠ” ê³µì—°ë³„ë¡œ ë‹¤ë¥¼ ìˆ˜ ìˆì–´ìš”. ì£¼ì°¨ì¥ì´ ì—†ìœ¼ë‹ˆ ëŒ€ì¤‘êµí†µ ì´ìš©ì„ ê¶Œì¥í•´ìš”."
    }
    
    # ì•„í‹°ìŠ¤íŠ¸ë³„ ìˆ˜ì • ë‚´ìš©ì´ ìˆìœ¼ë©´ ë°˜í™˜
    if artist_name in fixes:
        fixed_text = fixes[artist_name]
        # 100ìë¡œ ì •í™•íˆ ë§ì¶”ê¸°
        if len(fixed_text) > 100:
            fixed_text = fixed_text[:97] + "ìš”."
        elif len(fixed_text) < 100:
            # ë¶€ì¡±í•˜ë©´ íŒ¨ë”© ì¶”ê°€
            padding_needed = 100 - len(fixed_text)
            if padding_needed <= 3:
                fixed_text = fixed_text[:-1] + "ì–´ìš”."
            else:
                fixed_text = fixed_text
        return fixed_text[:100]
    
    # ë§¤ì¹­ë˜ì§€ ì•Šì€ ê²½ìš° ê¸°ë³¸ ì²˜ë¦¬
    if len(truncated_content) == 100:
        # ì´ë¯¸ 100ìì¸ ê²½ìš° ëë§Œ ë‹¤ë“¬ê¸°
        if not truncated_content.endswith(('ìš”', 'ë‹¤', 'í•´ìš”', 'ë‹ˆë‹¤', 'ì–´ìš”', 'ìŠµë‹ˆë‹¤')):
            return truncated_content[:97] + "ìš”."
    
    return truncated_content

def main():
    """ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜"""
    csv_path = Path('/Users/youz2me/Xcode/Livith-Data/output/main_output/concert_info.csv')
    
    if not csv_path.exists():
        print(f"âŒ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {csv_path}")
        return
    
    # CSV ì½ê¸°
    print("ğŸ“ CSV íŒŒì¼ ë¡œë“œ ì¤‘...")
    df = pd.read_csv(csv_path, encoding='utf-8')
    print(f"   ì´ {len(df)}ê°œ ë ˆì½”ë“œ ë¡œë“œë¨")
    
    # ë°±ì—… ìƒì„±
    backup_path = csv_path.parent / f"concert_info_backup_{int(time.time())}.csv"
    df.to_csv(backup_path, index=False, encoding='utf-8')
    print(f"ğŸ’¾ ë°±ì—… ìƒì„±: {backup_path}")
    print()
    
    # ì˜ë¦° í…ìŠ¤íŠ¸ ìˆ˜ì •
    print("ğŸ”§ í…ìŠ¤íŠ¸ ìˆ˜ì • ì¤‘...")
    print("=" * 70)
    
    modified_count = 0
    
    for idx, row in df.iterrows():
        content = str(row['content']).strip()
        
        # 100ìì´ê³  ë¶€ìì—°ìŠ¤ëŸ¬ìš´ ëë§ºìŒì¸ ê²½ìš°
        if len(content) == 100:
            natural_endings = ['.', 'ìš”', 'ë‹¤', 'í•´ìš”', 'ë‹ˆë‹¤', 'ì–´ìš”', 'ìŠµë‹ˆë‹¤', 'ë„¤ìš”', 'ë©ë‹ˆë‹¤', '!', '?', 'ì„¸ìš”']
            if not any(content.endswith(ending) for ending in natural_endings):
                print(f"ìˆ˜ì • ì¤‘: {row['artist_name']} - {row['category']}")
                
                # í…ìŠ¤íŠ¸ ìˆ˜ì •
                fixed_content = fix_truncated_text(
                    row['artist_name'],
                    row['concert_title'],
                    row['category'],
                    content
                )
                
                if fixed_content != content:
                    df.at[idx, 'content'] = fixed_content
                    print(f"   âœ… ìˆ˜ì • ì™„ë£Œ ({len(fixed_content)}ì)")
                    modified_count += 1
                else:
                    print(f"   â­ï¸  ë³€ê²½ ì—†ìŒ")
    
    print()
    print("=" * 70)
    print(f"ğŸ“Š ì²˜ë¦¬ ì™„ë£Œ: {modified_count}ê°œ ìˆ˜ì •ë¨")
    
    if modified_count > 0:
        # ì›ë³¸ íŒŒì¼ ì—…ë°ì´íŠ¸
        df.to_csv(csv_path, index=False, encoding='utf-8')
        print(f"âœ… íŒŒì¼ ì—…ë°ì´íŠ¸ ì™„ë£Œ: {csv_path}")
        
        # ìµœì¢… í†µê³„
        print("\nğŸ“ˆ ì—…ë°ì´íŠ¸ í›„ í†µê³„:")
        content_lengths = df['content'].str.len()
        print(f"   í‰ê·  ê¸€ì ìˆ˜: {content_lengths.mean():.1f}ì")
        print(f"   ìµœëŒ€ ê¸€ì ìˆ˜: {content_lengths.max()}ì")
        print(f"   100ì ì •í™•íˆ: {(content_lengths == 100).sum()}ê°œ")
        print(f"   100ì ì´ˆê³¼: {(content_lengths > 100).sum()}ê°œ (ì—†ì–´ì•¼ ì •ìƒ)")
        
        # 100ì ì´ˆê³¼ í™•ì¸
        over_100 = df[df['content'].str.len() > 100]
        if len(over_100) > 0:
            print("\nâš ï¸  ê²½ê³ : 100ì ì´ˆê³¼ í•­ëª© ë°œê²¬!")
            for idx, row in over_100.iterrows():
                print(f"   - {row['artist_name']}: {len(row['content'])}ì")
    else:
        print("âŒ ìˆ˜ì •ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")

if __name__ == "__main__":
    main()